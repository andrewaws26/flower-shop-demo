<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Today’s Flower Prices</title>

  <!-- Security headers via meta (best effort on static hosts like GitHub Pages) -->
  <meta http-equiv="Content-Security-Policy"
        content="default-src 'self';
                 connect-src https://docs.google.com;
                 style-src 'self' 'unsafe-inline';
                 img-src 'self' https: data:;
                 frame-ancestors 'none';
                 base-uri 'self';
                 form-action 'none'">
  <meta name="referrer" content="no-referrer">
  <meta http-equiv="Permissions-Policy"
        content="geolocation=(), microphone=(), camera=(), payment=(), usb=()">

  <style>
    :root {
      --bg: #fffaf7; --fg: #222; --card: #fff; --card-border: #f1e3dc;
      --accent: #f3d6c6; --shadow: 0 3px 12px rgba(0,0,0,.05); --radius: 18px; --pad: 16px;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; line-height: 1.25;
    }
    @media (prefers-color-scheme: dark) {
      :root { --bg:#12100e; --fg:#f4efe9; --card:#1d1a17; --card-border:#3a2f29; --accent:#5a3d30; --shadow:0 2px 10px rgba(0,0,0,.35); }
    }
    html, body { height: 100%; }
    body { margin:0; color:var(--fg); background:var(--bg); -webkit-font-smoothing:antialiased; text-rendering:optimizeLegibility; }
    header {
      position: sticky; top: 0; z-index: 10;
      padding: calc(var(--pad) + env(safe-area-inset-top)) calc(var(--pad) + env(safe-area-inset-right)) var(--pad) calc(var(--pad) + env(safe-area-inset-left));
      border-bottom: 4px solid var(--accent); background: var(--bg);
      display:grid; grid-template-columns: 1fr auto; gap:12px; align-items:center;
    }
    h1 { margin:0; font-size: clamp(22px, 4vw, 40px); letter-spacing:.2px; }
    .time { justify-self:end; font-size: clamp(13px, 2.5vw, 16px); opacity:.75; }
    .wrap { padding: 16px calc(var(--pad) + env(safe-area-inset-right)) calc(24px + env(safe-area-inset-bottom)) calc(var(--pad) + env(safe-area-inset-left));
            max-width: 1200px; margin:0 auto; }
    .grid { display:grid; gap:14px; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); }
    .category { grid-column:1 / -1; font-weight:700; letter-spacing:.04em; font-size: clamp(12px, 1.8vw, 14px); color:#9a6b58; text-transform:uppercase; margin: 6px 4px 2px; }
    .card { background:var(--card); border:2px solid var(--card-border); border-radius:var(--radius); padding:16px; box-shadow:var(--shadow); }
    .item { display:flex; justify-content:space-between; align-items:baseline; gap:10px; flex-wrap:wrap; }
    .name { font-size: clamp(18px, 4.2vw, 26px); font-weight:700; min-width:40%; }
    .price { font-size: clamp(18px, 5vw, 28px); font-weight:800; margin-left:auto; }
    .note { margin-top:6px; opacity:.85; font-size: clamp(14px, 3.8vw, 16px); word-break: break-word; }
    .offline { position:fixed; right:calc(12px + env(safe-area-inset-right)); bottom:calc(12px + env(safe-area-inset-bottom));
               background:#ffe4c4; border:2px solid #f3c19b; padding:8px 12px; border-radius:12px; display:none; max-width:min(92vw, 420px); box-shadow:var(--shadow); }
    @media (prefers-color-scheme: dark) { .offline { background:#60412f; border-color:#8a5d47; color:#fff0e5; } }
    @media (max-width: 480px) { header { grid-template-columns:1fr; } .time { justify-self:start; } .wrap { padding-top:12px; } .card { padding:14px; border-radius:16px; } }
    :focus-visible { outline: 3px solid #f3b796; outline-offset: 2px; border-radius: 10px; }
    @media (prefers-reduced-motion: reduce) { * { animation:none !important; transition:none !important; } }
  </style>
</head>
<body>
  <header>
    <h1>Today’s Flowers</h1>
    <div class="time" id="updated" aria-live="polite">Loading…</div>
  </header>

  <main class="wrap">
    <div class="grid" id="grid"></div>
  </main>

  <div class="offline" id="offline" role="status">Offline – showing last saved prices</div>

  <!-- External JS (so CSP can forbid inline scripts) -->
  <script src="./app.js" defer></script>
</body>
</html>
